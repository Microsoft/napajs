language: node_js
node_js:
# ISSUE with 'node' (v8.x.x). Need to fix. See https://github.com/Microsoft/napajs/issues/5
- 'node'
- '6'
- '4'
os:
# ISSUE with 'linux'. Need to fix. See https://github.com/Microsoft/napajs/issues/4
- linux
- osx
addons:
    apt:
      sources:
      - ubuntu-toolchain-r-test
      packages:
      - g++-5

# should re-enable extra build in matrix after ISSUE 4 and 5 resolved
# matrix:
#   include:
#   - os: linux
#     compiler: g++-6
#     addons:
#       apt:
#         sources:
#         - ubuntu-toolchain-r-test
#         packages:
#         - g++-6
#     env:
#     - COMPILER_OVERRIDE="CXX=g++-6 CC=gcc-6"
#   - os: linux
#     compiler: clang
#     addons:
#       apt:
#         packages:
#         - clang-3.4
#     env:
#     - COMPILER_OVERRIDE="CC=clang-3.4 CXX=clang++-3.4"

before_install:
- if [ $TRAVIS_OS_NAME == linux ]; then
    if [ "$COMPILER_OVERRIDE" == "" ]; then
      #use g++5 by default
      export CXX="g++-5" CC="gcc-5"
    else
      export ${COMPILER_OVERRIDE}
    fi
  fi
install:
- npm install cmake-js -g
- npm install
script:
- npm test
- npm run unittest
after_success:
- "./node_modules/.bin/node-pre-gyp package"
- "./node_modules/.bin/node-pre-gyp-github publish"
env:
  global:
    secure: S7DDixQ9tPK0hi7iGGNhipNUZtOa3qN4xwKpvUdB8XSBMP7N2LBjh/Bzjh/9zq7dyAVbUBrXHZkGICIYEDpGvjenIGUcr0mUQc6TDcf8Pk0OgY1jpF3I/eBdKX8e+WnfmOwD87SABQGdivlkZw6LXgT1Cw3fSxGZnkBHmjpKtJASZNi3AbS8agtiDPBwSxWiQQvIXdp35fIKh08KTeWbyZ9f9tlmVXZlbN78EXANR3Jc1UcL2JgCJoj7XxESpyUQpZP+rOrBPd9vhUORsK/et5ZTKJb66oeJcK4fq21hqMJxDIhpNnBgFC6KEmgOyDeqjLCp5a+520+QmE0+V0EAgVDXSaaLBgkV3DJShhuTX+ti4NgAc1MAxbDkXBF6WUAT3bOvr0BpuUhYW8j+wAs5bv1YnPYXja2umK+shVQ3epXtZ/Cdg3rhNymb3W6q36+z3pbB/ceRsOmLJollbF/18Iumo/iYHfxYiVXrF5OdVMexk/dLQ3s6FyjIqjxERjQhZqX34PTNmZBYk/NTyLut27fxEp21uhHqH6L7Un0IiDBTpsnpVhwRyOrzqFi/CJJC/Lbw76M1j47LPEymTz3E8rReDVBfj7Wfce8pB0D41moR/AbgtZUPeNH9XAduHz0ScMJNv+i0kH4SmqEvSbSVu3liknYlRumFn7MAEk2vfps=
